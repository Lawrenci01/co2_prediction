2026-02-15 23:17:53,191 - INFO - ============================================================
2026-02-15 23:17:53,191 - INFO - WEEKLY PIPELINE EXECUTION STARTED
2026-02-15 23:17:53,191 - INFO - ============================================================
2026-02-15 23:17:53,191 - INFO - ============================================================
2026-02-15 23:17:53,192 - INFO - CO2 Prediction Pipeline Started
2026-02-15 23:17:53,192 - INFO - Time: 2026-02-15 23:17:53
2026-02-15 23:17:53,192 - INFO - ============================================================
2026-02-15 23:17:53,310 - INFO - Database engine created successfully
2026-02-15 23:17:54,412 - INFO - Total rows in sensor_data: 43200, latest: 2026-01-30 23:59:00
2026-02-15 23:17:54,661 - WARNING - Only 0 recent rows (need >72). Fetching all data...
2026-02-15 23:17:55,654 - INFO -    Frequency: H
2026-02-15 23:17:55,662 - INFO - Created 648 sequences
2026-02-15 23:17:55,662 - INFO -   Training: 518 samples
2026-02-15 23:17:55,663 - INFO -   Validation: 130 samples
2026-02-15 23:18:16,838 - INFO -    Final training loss: 0.0007
2026-02-15 23:18:16,838 - INFO -    Final validation loss: 0.0014
2026-02-15 23:18:16,845 - INFO -    Steps per day: 24
2026-02-15 23:18:21,558 - INFO -    25% complete...
2026-02-15 23:18:25,194 - INFO -    50% complete...
2026-02-15 23:18:28,837 - INFO -    75% complete...
2026-02-15 23:18:32,548 - INFO -    100% complete...
2026-02-15 23:18:32,764 - ERROR - Error storing predictions: (mysql.connector.errors.ProgrammingError) 1054 (42S22): Unknown column 'forecast_day' in 'field list'
[SQL: 
                        INSERT INTO sensor_data_prediction 
                        (timestamp, co2, temperature, humidity, forecast_day, created_at)
                        VALUES (%(ts)s, %(co2)s, %(temp)s, %(hum)s, %(day)s, %(created)s)
                    ]
[parameters: {'ts': datetime.datetime(2026, 2, 16, 23, 18, 32, 549312), 'co2': 419.7072448730469, 'temp': 25.10411262512207, 'hum': 69.37981414794922, 'day': 1, 'created': datetime.datetime(2026, 2, 15, 23, 18, 32, 549312)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Unknown column 'forecast_day' in 'field list'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.ProgrammingError: 1054 (42S22): Unknown column 'forecast_day' in 'field list'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\lawrence\OneDrive\Desktop\co2_prediction_test\train_and_predict.py", line 307, in predict_and_store_daily
    conn.execute(
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "C:\Users\lawrence\AppData\Local\Programs\Python\Python310\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.ProgrammingError: (mysql.connector.errors.ProgrammingError) 1054 (42S22): Unknown column 'forecast_day' in 'field list'
[SQL: 
                        INSERT INTO sensor_data_prediction 
                        (timestamp, co2, temperature, humidity, forecast_day, created_at)
                        VALUES (%(ts)s, %(co2)s, %(temp)s, %(hum)s, %(day)s, %(created)s)
                    ]
[parameters: {'ts': datetime.datetime(2026, 2, 16, 23, 18, 32, 549312), 'co2': 419.7072448730469, 'temp': 25.10411262512207, 'hum': 69.37981414794922, 'day': 1, 'created': datetime.datetime(2026, 2, 15, 23, 18, 32, 549312)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2026-02-15 23:18:32,789 - INFO - ============================================================
2026-02-15 23:18:32,789 - INFO - WEEKLY PIPELINE COMPLETED SUCCESSFULLY
2026-02-15 23:18:32,789 - INFO - ============================================================
2026-02-15 23:30:48,446 - INFO - ============================================================
2026-02-15 23:30:48,447 - INFO - WEEKLY PIPELINE EXECUTION STARTED
2026-02-15 23:30:48,447 - INFO - ============================================================
2026-02-15 23:30:48,447 - INFO - =======================================================
2026-02-15 23:30:48,449 - INFO - CO2 Prediction Pipeline — 2026-02-15 23:30:48
2026-02-15 23:30:48,456 - INFO - =======================================================
2026-02-15 23:30:48,556 - INFO - Database engine created successfully
2026-02-15 23:30:50,892 - INFO - Created 648 sequences
2026-02-15 23:30:50,892 - INFO -   Training: 518 samples
2026-02-15 23:30:50,893 - INFO -   Validation: 130 samples
2026-02-15 23:31:01,019 - INFO -    Training loss: 0.0006
2026-02-15 23:31:01,020 - INFO -    Validation loss: 0.0013
2026-02-15 23:31:05,350 - INFO -    25% complete...
2026-02-15 23:31:09,000 - INFO -    50% complete...
2026-02-15 23:31:12,708 - INFO -    75% complete...
2026-02-15 23:31:16,399 - INFO -    100% complete...
2026-02-15 23:31:16,628 - INFO - ============================================================
2026-02-15 23:31:16,628 - INFO - WEEKLY PIPELINE COMPLETED SUCCESSFULLY
2026-02-15 23:31:16,629 - INFO - ============================================================
2026-02-16 15:47:35,572 - INFO - Database engine initialized successfully
2026-02-16 15:47:35,576 - INFO - Starting Flask app on port 5000
2026-02-16 15:47:35,599 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.100.42:5000
2026-02-16 15:47:35,601 - INFO - [33mPress CTRL+C to quit[0m
2026-02-16 15:47:43,881 - INFO - 192.168.100.42 - - [16/Feb/2026 15:47:43] "GET / HTTP/1.1" 200 -
2026-02-16 15:47:44,190 - INFO - 192.168.100.42 - - [16/Feb/2026 15:47:44] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2026-02-16 15:47:55,475 - ERROR - Error fetching latest prediction: (mysql.connector.errors.DatabaseError) 2005 (HY000): Unknown MySQL server host 'mysql-c8cdfc5-ariasampoy414-f96b.c.aivencloud.com' (11001)
(Background on this error at: https://sqlalche.me/e/20/4xp6)
2026-02-16 15:47:55,479 - INFO - 192.168.100.42 - - [16/Feb/2026 15:47:55] "[35m[1mGET /api/predictions/latest HTTP/1.1[0m" 500 -
2026-02-16 15:49:44,053 - ERROR - Error fetching latest prediction: (mysql.connector.errors.DatabaseError) 2005 (HY000): Unknown MySQL server host 'mysql-c8cdfc5-ariasampoy414-f96b.c.aivencloud.com' (11001)
(Background on this error at: https://sqlalche.me/e/20/4xp6)
2026-02-16 15:49:44,054 - INFO - 192.168.100.42 - - [16/Feb/2026 15:49:44] "[35m[1mGET /api/predictions/latest HTTP/1.1[0m" 500 -
2026-02-16 15:50:28,240 - INFO - Database engine initialized successfully
2026-02-16 15:50:28,242 - INFO - Starting Flask app on port 5000
2026-02-16 15:50:28,267 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.60.29:5000
2026-02-16 15:50:28,268 - INFO - [33mPress CTRL+C to quit[0m
2026-02-16 15:51:08,829 - INFO - 192.168.60.29 - - [16/Feb/2026 15:51:08] "GET / HTTP/1.1" 200 -
2026-02-16 15:51:08,938 - INFO - 192.168.60.29 - - [16/Feb/2026 15:51:08] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
